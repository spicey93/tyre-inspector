<!DOCTYPE html>
<html lang="en" class="h-full bg-slate-50">
  <head>
    <%- include('../partials/head', { title: 'Inspection Report — Tyre Inspector' }) %>
  </head>
  <body class="h-full">
    <%- include('../partials/header-mobile') %>

    <main class="max-w-4xl mx-auto px-4 md:px-8 py-6 space-y-6">
      <header class="flex items-start justify-between gap-3">
        <div>
          <h1 class="text-2xl md:text-3xl font-extrabold text-slate-900">Inspection Report</h1>
          <p class="text-slate-600 mt-1">Code <span class="font-mono font-semibold"><%= inspection.code %></span> ·
            VRM <span class="font-semibold"><%= inspection.vrm %></span></p>
          <p class="text-slate-500 text-sm">Created <%= new Date(inspection.createdAt).toLocaleString('en-GB') %></p>
        </div>
        <a href="/inspections" class="inline-flex items-center gap-2 rounded-xl border border-slate-300 bg-white px-4 py-2.5 font-semibold text-slate-800 hover:bg-slate-50">
          Back
        </a>
      </header>

      <!-- Vehicle (if present) -->
      <% if (inspection.vehicle) { %>
      <section class="rounded-2xl border border-slate-200 bg-white p-4">
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
          <div><div class="text-slate-500">Make / Model</div><div class="font-medium text-slate-900"><%= inspection.vehicle.make || '—' %> <%= inspection.vehicle.model || '' %></div></div>
          <div><div class="text-slate-500">Year</div><div class="font-medium text-slate-900"><%= inspection.vehicle.year || '—' %></div></div>
          <div><div class="text-slate-500">Fuel</div><div class="font-medium text-slate-900"><%= inspection.vehicle.fuel || '—' %></div></div>
        </div>
      </section>
      <% } %>

      <!-- Summary -->
      <section class="grid grid-cols-2 sm:grid-cols-4 gap-3 md:gap-4">
        <div class="rounded-xl border bg-white p-4">
          <div class="text-xs text-slate-500">Mileage</div>
          <div class="mt-1 text-xl font-bold text-slate-900"><%= typeof inspection.mileage === 'number' ? inspection.mileage : '—' %></div>
        </div>
        <div class="rounded-xl border bg-white p-4">
          <div class="text-xs text-slate-500">Offside Front</div>
          <div class="mt-1 text-sm font-medium text-slate-900"><%= inspection.offside?.front?.size || '—' %></div>
        </div>
        <div class="rounded-xl border bg-white p-4">
          <div class="text-xs text-slate-500">Nearside Front</div>
          <div class="mt-1 text-sm font-medium text-slate-900"><%= inspection.nearside?.front?.size || '—' %></div>
        </div>
        <div class="rounded-xl border bg-white p-4">
          <div class="text-xs text-slate-500">Status</div>
          <div class="mt-1 text-sm font-medium text-slate-900"><%= (inspection.notes && inspection.notes.length) ? 'With notes' : '—' %></div>
        </div>
      </section>

      <!-- Tyre details (simple, two columns) -->
      <% function tyreCard(pos, data) { %>
        <article class="rounded-2xl border border-slate-200 bg-white p-4">
          <h3 class="text-sm font-semibold text-slate-800"><%= pos %></h3>
          <div class="mt-2 grid grid-cols-2 gap-2 text-sm">
            <div><span class="text-slate-500">Brand</span><div class="font-medium"><%= data?.brand || '—' %></div></div>
            <div><span class="text-slate-500">Model</span><div class="font-medium"><%= data?.model || '—' %></div></div>
            <div><span class="text-slate-500">Size</span><div class="font-medium"><%= data?.size || '—' %></div></div>
            <div><span class="text-slate-500">Pressure</span><div class="font-medium"><%= (typeof data?.pressure === 'number' ? data.pressure : '—') %></div></div>
            <div class="col-span-2">
              <span class="text-slate-500">Tread (mm)</span>
              <div class="font-medium">
                <%= (data?.treadDepth?.inner ?? '—') %> / <%= (data?.treadDepth?.middle ?? '—') %> / <%= (data?.treadDepth?.outer ?? '—') %>
              </div>
            </div>
            <div><span class="text-slate-500">DOT</span><div class="font-medium"><%= data?.dot || '—' %></div></div>
            <div><span class="text-slate-500">Condition</span><div class="font-medium capitalize"><%= data?.condition || '—' %></div></div>
            <div class="col-span-2"><span class="text-slate-500">Notes</span><div class="font-medium whitespace-pre-wrap"><%= data?.notes || '—' %></div></div>
            <div class="col-span-2"><span class="text-slate-500">Tags</span><div class="font-medium"><%= (Array.isArray(data?.tags) && data.tags.length) ? data.tags.join(', ') : '—' %></div></div>
          </div>
        </article>
      <% } %>

      <section class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <%- tyreCard('Offside Front', inspection.offside?.front) %>
        <%- tyreCard('Offside Rear', inspection.offside?.rear) %>
        <%- tyreCard('Nearside Front', inspection.nearside?.front) %>
        <%- tyreCard('Nearside Rear', inspection.nearside?.rear) %>
      </section>
    </main>
  </body>
</html>
